<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Whats GitOps?GitOps principles uses git repositories as single source of truth to deliver infrastructure as code. GitOps workflow?GitOps uses Git as the version control system for infrastructure confi">
<meta property="og:type" content="article">
<meta property="og:title" content="ArgoCD, why not?">
<meta property="og:url" content="http://kaxem.github.io/2023/10/17/ArgoCD/index.html">
<meta property="og:site_name" content="Lift Your Skinny Fist">
<meta property="og:description" content="Whats GitOps?GitOps principles uses git repositories as single source of truth to deliver infrastructure as code. GitOps workflow?GitOps uses Git as the version control system for infrastructure confi">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://kaxem.github.io/images/ArgoCD/2.webp">
<meta property="og:image" content="http://kaxem.github.io/images/ArgoCD/argo.png">
<meta property="article:published_time" content="2023-10-17T00:00:00.000Z">
<meta property="article:author" content="Xai">
<meta property="article:tag" content="GitOps">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://kaxem.github.io/images/ArgoCD/2.webp">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>ArgoCD, why not?</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/kaxem">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/11/26/Cassandra/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/12/30/2023/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://kaxem.github.io/2023/10/17/ArgoCD/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://kaxem.github.io/2023/10/17/ArgoCD/&text=ArgoCD, why not?"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://kaxem.github.io/2023/10/17/ArgoCD/&title=ArgoCD, why not?"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://kaxem.github.io/2023/10/17/ArgoCD/&is_video=false&description=ArgoCD, why not?"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ArgoCD, why not?&body=Check out this article: http://kaxem.github.io/2023/10/17/ArgoCD/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://kaxem.github.io/2023/10/17/ArgoCD/&title=ArgoCD, why not?"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://kaxem.github.io/2023/10/17/ArgoCD/&title=ArgoCD, why not?"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://kaxem.github.io/2023/10/17/ArgoCD/&title=ArgoCD, why not?"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://kaxem.github.io/2023/10/17/ArgoCD/&title=ArgoCD, why not?"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://kaxem.github.io/2023/10/17/ArgoCD/&name=ArgoCD, why not?&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://kaxem.github.io/2023/10/17/ArgoCD/&t=ArgoCD, why not?"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Whats-GitOps"><span class="toc-number">1.</span> <span class="toc-text">Whats GitOps?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GitOps-workflow"><span class="toc-number">2.</span> <span class="toc-text">GitOps workflow?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Why-we-need-GitOps"><span class="toc-number">3.</span> <span class="toc-text">Why we need GitOps?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pros-of-GitOps"><span class="toc-number">4.</span> <span class="toc-text">Pros of GitOps</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Argo-CD"><span class="toc-number"></span> <span class="toc-text">Argo CD</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ArgoCD-advantages"><span class="toc-number">1.</span> <span class="toc-text">ArgoCD advantages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Argo-CD-configuration"><span class="toc-number">2.</span> <span class="toc-text">Argo CD configuration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ArgoCD-best-practices"><span class="toc-number">3.</span> <span class="toc-text">ArgoCD best practices</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        ArgoCD, why not?
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Xai</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-10-17T00:00:00.000Z" itemprop="datePublished">2023-10-17</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/GitOps/" rel="tag">GitOps</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Whats-GitOps"><a href="#Whats-GitOps" class="headerlink" title="Whats GitOps?"></a>Whats GitOps?</h2><p>GitOps principles uses git repositories as single source of truth to deliver infrastructure as code.</p>
<h2 id="GitOps-workflow"><a href="#GitOps-workflow" class="headerlink" title="GitOps workflow?"></a>GitOps workflow?</h2><p>GitOps uses Git as the version control system for infrastructure configurations.<br>CI-CD pipelines usually triggered by external event like code being pushed to a repository.<br><strong>In GitOps workflow, changes are made using pull requests which modify state in the Git repository.</strong></p>
<h2 id="Why-we-need-GitOps"><a href="#Why-we-need-GitOps" class="headerlink" title="Why we need GitOps?"></a>Why we need GitOps?</h2><p>in Basic CI&#x2F;CD every one has access to kubernetes cluster and can change it by pushing code into git repository. So it make it hard to trace who executed what in kubernetes.<br>But in GitOps methode an agent is installed on K8s Cluster, it tracks changes between git state and kubernetes state then if there was an change <strong>Pulls</strong> it from Git repository.</p>
<p><img src="/images/ArgoCD/2.webp" alt="pull based"></p>
<h2 id="Pros-of-GitOps"><a href="#Pros-of-GitOps" class="headerlink" title="Pros of GitOps"></a>Pros of GitOps</h2><ul>
<li>Rolling back in GitOps methode is easy</li>
<li>If a commit breaks k8s we can use <code>git revert</code> into last commit</li>
<li><strong>Increases Security</strong>: you dont have to give every team member to execute changes. Only CD pipeline needs access.<ul>
<li>With traditional CI&#x2F;CD you need to install kubectl or helm in order of applying changes into k8s.</li>
<li>you need to config access to K8s in your runner.</li>
</ul>
</li>
</ul>
<hr>
<h1 id="Argo-CD"><a href="#Argo-CD" class="headerlink" title="Argo CD"></a>Argo CD</h1><p>Expect of external access to k8s we have ArgoCD as a part of k8s cluster<br/><br><img src="/images/ArgoCD/argo.png" alt="Argo"></p>
<ul>
<li>Argo CD helps us to seperate CI from CD: in other words CI will change bu developers and DevOps engineers but CD is automatically done by Argo.</li>
</ul>
<h2 id="ArgoCD-advantages"><a href="#ArgoCD-advantages" class="headerlink" title="ArgoCD advantages"></a>ArgoCD advantages</h2><ul>
<li><p>Git as source of truth: If someone apply a change in k8s cluster manually, ArgoCD checks diffrents between actual state(kubernetes state) and Desired state(last modified state in git repository), then it change git’s state automatically. This helps to k8s manifests in git remain source of truth.</p>
</li>
<li><p>Easy rollback: expect of using <code>kubectl delete</code> or such as things we can easily roll back to last state with argo cd.</p>
</li>
<li><p>Cluster disaster recovery: if a k8s cluster get completely crashed and not working. we can make a new cluster and install argo agent on it then point argo to git repository, so it will deploy all resources again.</p>
</li>
<li><p><strong>K8s Access Control</strong>: as security best practice, you dont give everyone access to k8s cluster. u just give them access to git repositories.</p>
</li>
<li><p>Working with multiple clusters:<br/><br>assume that we have different enviroments like developement and staging and production and we don’t want to one config for each of them. thers’s two way to handle this<br/> 	1. Use multiple braches and diffrent configs (it’s not best practice)<br/> 	2. Use overlays in Kustomize<br>with this tool we can make base files then overlay configs for each enviroment.</p>
</li>
</ul>
<h2 id="Argo-CD-configuration"><a href="#Argo-CD-configuration" class="headerlink" title="Argo CD configuration"></a>Argo CD configuration</h2><p>let’s take a look at minimal argo config:<br>    apiVersion: argoproj.io&#x2F;v1alpha1<br>    kind: Application<br>    metadata:<br>    name: guestbook<br>    namespace: argocd<br>    spec:<br>    project: default<br>    source:<br>        repoURL: <a target="_blank" rel="noopener" href="https://github.com/argoproj/argocd-example-apps.git">https://github.com/argoproj/argocd-example-apps.git</a><br>        targetRevision: HEAD<br>        path: guestbook<br>    destination:<br>        server: <a target="_blank" rel="noopener" href="https://kubernetes.default.svc/">https://kubernetes.default.svc</a><br>        namespace: guestbook</p>
<ul>
<li>apiVersion: latest argo version</li>
<li>source: source of git repository</li>
<li>destination: with k8s service to deploy on</li>
</ul>
<h2 id="ArgoCD-best-practices"><a href="#ArgoCD-best-practices" class="headerlink" title="ArgoCD best practices"></a>ArgoCD best practices</h2><ol>
<li>Use separate Git reposiroty for kubernetes manifests to keep Kubernetes configs separate from source code is suggested for cleaner audit log and separation access.</li>
<li>Use Git-SHA tags or SemVer tag to immute manifests.</li>
</ol>
<br/>
<br/>
<br/>







<p>Resources: </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://argo-cd.readthedocs.io/en/stable/user-guide/best_practices/">Declarative GitOps CD for Kubernetes</a></li>
<li><a target="_blank" rel="noopener" href="https://www.redhat.com/en/topics/devops/what-is-gitops">What is GitOps by RedHat</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=MeU5_k9ssrs"> ArgoCD Tutorial for Beginners by Tech with Nana</a></li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://github.com/kaxem">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Whats-GitOps"><span class="toc-number">1.</span> <span class="toc-text">Whats GitOps?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GitOps-workflow"><span class="toc-number">2.</span> <span class="toc-text">GitOps workflow?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Why-we-need-GitOps"><span class="toc-number">3.</span> <span class="toc-text">Why we need GitOps?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pros-of-GitOps"><span class="toc-number">4.</span> <span class="toc-text">Pros of GitOps</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Argo-CD"><span class="toc-number"></span> <span class="toc-text">Argo CD</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ArgoCD-advantages"><span class="toc-number">1.</span> <span class="toc-text">ArgoCD advantages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Argo-CD-configuration"><span class="toc-number">2.</span> <span class="toc-text">Argo CD configuration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ArgoCD-best-practices"><span class="toc-number">3.</span> <span class="toc-text">ArgoCD best practices</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://kaxem.github.io/2023/10/17/ArgoCD/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://kaxem.github.io/2023/10/17/ArgoCD/&text=ArgoCD, why not?"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://kaxem.github.io/2023/10/17/ArgoCD/&title=ArgoCD, why not?"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://kaxem.github.io/2023/10/17/ArgoCD/&is_video=false&description=ArgoCD, why not?"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ArgoCD, why not?&body=Check out this article: http://kaxem.github.io/2023/10/17/ArgoCD/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://kaxem.github.io/2023/10/17/ArgoCD/&title=ArgoCD, why not?"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://kaxem.github.io/2023/10/17/ArgoCD/&title=ArgoCD, why not?"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://kaxem.github.io/2023/10/17/ArgoCD/&title=ArgoCD, why not?"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://kaxem.github.io/2023/10/17/ArgoCD/&title=ArgoCD, why not?"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://kaxem.github.io/2023/10/17/ArgoCD/&name=ArgoCD, why not?&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://kaxem.github.io/2023/10/17/ArgoCD/&t=ArgoCD, why not?"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2023
    Xai
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/kaxem">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
